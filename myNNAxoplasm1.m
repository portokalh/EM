function [Y,Xf,Af] = myNNAxoplasm1(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 26-Aug-2015 10:25:51.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 2xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [4383;98.4824988283244;29.1777037224712;0.47695917057058;-86.3207314337189;4399;-279;74.7034733099755;0.374359435052964;0.190404895972514;289.911;0.808104886769964;8782;80.4696720685814;0.0139495479139544];
x1_step1_gain = [1.89272059658553e-06;0.000964857826021289;0.00141479099020191;3.8419928979153;0.0113541985269045;1.74699189832507e-06;0.00714285714285714;0.00183888372078794;3.32968016063788;3.47344392373147;9.46203728922661e-05;10.4223602484472;9.08469433410326e-07;0.00118377661089076;23.4335082285974];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.7483695472010123417;-1.6667466060045326159;-1.5772750017873613526;-1.3889743596679036131;-1.096988878812809709;1.3361158692969425932;1.0204810343848447207;0.74715912013810192871;1.1808549569326698414;-0.62149391140360121799;-0.95520608193553413479;0.54599188909026508121;-0.23537613573967453018;0.32292949549774219165;-0.009566220738767953341;-0.06093861276832779339;0.12820644034726275118;-0.37124984150361112212;0.4435407187427668485;0.62055414286529120282;-0.46911856092960407816;0.95654600216779617217;-0.95622245948010853311;-1.1634052184472341018;0.94926081582253174496;-1.3077997525123863376;1.4715715372506559255;-1.6419514113464783733;1.6483437806739138498;1.7539091391978116619];
IW1_1 = [-0.59491384149945325532 0.38784013213920348617 -1.0047594689427010728 0.12877512430260892873 0.36236101128832365337 0.48280212575919245754 0.34539084143401083127 -0.23430703569301872258 -0.10733475409813764134 -0.14875239744416063337 0.34763606542840658209 0.63528155007401143628 0.32423861911179169271 -0.57222595448324897749 -0.14384462195402575313;0.40192962936963289033 -0.18739109306367640606 -0.47539990130308290572 -0.37534495378484028505 0.74237737362133982 -0.32789991746737640055 0.73231808034498757642 0.25156179367853503948 -0.0043196843824933398026 0.68779802957394731155 -0.038335990161851934976 -0.75915943175926670072 0.13087398985538009621 -0.3917589760423684786 0.28506020220469541204;0.25050174211541875735 0.20977151690099340997 0.39631070278502600335 0.70345962644048798396 0.49944182548772808605 0.69574643011492554034 0.31410239173522402911 0.54399138778938549432 0.44562762832355085063 0.18802669113814735047 0.59784063765679584801 -0.19429011832071979571 -0.41469863952599989032 -0.53632569647017025449 -0.34199319037160463841;0.12791989746315046705 0.4488852534531480587 0.31789338286253887578 0.69724159385074535589 -0.021530701258782355967 0.46886621194936850543 -0.14126466391531247724 0.55636982542125323903 0.33794549525504335996 0.028738203393515376893 0.044392789494620533974 -0.71584802342460251978 0.39054294298352776327 0.65746256868721453248 -0.71121041219177449921;0.110366654742615658 -0.83085700246546945191 0.49910174047452671164 -0.49147176030929956569 0.52121895371643978123 -0.30709767297011286713 0.65613682021267594191 0.60924131352166366327 0.29005170875033065014 0.78811874004611970346 -0.037557809023284795258 -0.42187846788405808374 -0.55582750607664788145 0.57862969114302964524 -0.18005687207727880117;-0.80417105674677880067 -0.55921164596771399946 0.037726572847177231029 0.60092981441247628194 -0.17933384141751870788 -0.12864030756343175499 -0.41599868344946300258 -0.48058689528182280126 0.34289346683485838474 -0.54527777919965925157 0.18864299259256880892 -0.65098129004555616017 -0.31860502315167604781 0.43593535639598707254 -0.38704932982018663834;-0.13610557887563295987 0.69503666703043376351 -0.45605230565126403386 0.41844298252854600362 0.54390149526851361284 0.29322586474563799852 -0.57993238332706598115 -0.18424865774013796105 0.66681318961950641899 0.46781647053975028427 -0.087616933158880555554 -0.42905903744097623198 0.53872935642875574569 0.37252919092542313706 0.63494596738690445292;0.055431111327444750059 0.22630184659048765972 0.65018450229844004795 0.046405569870537080601 0.64142940429645933786 0.56980320120858574118 -0.68991833401837765471 0.57868598500902324044 0.36427547884017391633 -0.48678768205734351815 -0.25017843286811347614 -0.54186233929552618527 0.59842245562373186374 -0.36674111564188283108 0.66615494711667178063;-0.57724098720452199363 0.029197264835290052953 0.7226034049444435281 0.42595387640457377243 0.97118250064648203868 0.13705845526694560021 -0.48250163860311900965 0.63604957611259527184 1.8563975354750910096 0.22334597250176344008 0.29426278098353048085 -0.39730422777438068049 -0.26563178682088600668 -0.019280857359342262747 -0.50877449989570877609;0.31147206890924822309 -0.15992342140126414307 -0.34710943150360995535 0.75072309504828260707 -0.23386240621720910671 0.087794074742358965691 -0.23989041393937038382 0.0041170018392004265051 -0.79079544577622762347 -0.69576079963024528574 0.56893743776558514114 -0.45566356639493282854 -0.31948005164489640118 -0.49886809613278071396 -0.70372800824226133809;0.72982730329572598205 -1.3642720813923649992 -0.23418229140466984006 0.51966935063740171685 -0.59980329885353989017 -0.29449809039574409431 -0.54548716185450896177 -0.43097289619043632758 -0.48104639642592728066 0.39530895814661060061 -0.38361449723365742548 -0.072781006449553417581 0.25229344614123883073 -1.4046639922471990669 1.3405014908397256956;-0.34880844121500836907 -0.19037663110086561202 0.69822945068144304237 0.68038766388073013136 -0.43258096928735467745 -0.10420515733473126319 -0.60609682821316013257 0.53688077759991836846 -0.16770636824859974645 -1.0546725718073997058 -0.52721158550095614803 0.29148880188425058124 0.54333996116425997691 -0.20461670784399793588 0.7272103744604186959;0.3577463606719673006 -0.47240891784550126387 0.33444938295781445614 0.2060988051590386394 0.37850738252950910656 0.32642012440880857627 0.13034207921634072269 0.012054256374811417318 -0.034706641384518392701 0.49775832903845634858 -0.14963055934721358753 0.774694022746825528 0.67670750097750265173 0.30845524540567392791 0.93446451351718917699;-0.43385474615639862961 0.26478111599148379529 0.58791948960044293493 -0.44800531511437546861 0.73005568553781863272 0.52942576039470201632 -0.50569420967902911634 -0.04409572000508592271 -0.47084862001564664613 0.4273218639407843078 -0.1088105220658031197 0.36715031519376339908 0.15234851992036099744 0.42098744918343539156 -1.0075986786568700282;0.62776840609185236008 -0.52637996187175606355 -0.044673627866803441999 -0.42789300471501762191 0.8538488934475199077 0.41697433830945568323 -0.64220288013142212691 0.063312504574543279623 0.36918215064720744101 1.2902857974471582114 -0.1359589167783288588 -0.62704802256836955632 -0.2792904501664199568 0.15599987907711099222 -0.489698169863466648;-0.51157341019966595663 0.05819008834009227471 0.098001148976447530203 0.057311063134774124783 0.4151360394309169255 -0.72351919123990315885 0.15411052654076942692 0.1447808165258711588 1.0284054047649175967 1.0426965343283054466 0.73838862015430328789 -0.33146381295217658414 0.72330405912277595526 0.091678187655685666746 0.21909027372758602126;0.13112868888019163505 -0.89812013043353366992 0.034772034994641418115 0.26691236803867240956 -0.31560076570416378816 0.29574539529475663002 0.67339815915102940735 0.70196596528958143946 -1.2874223999740397328 -0.13273664637906951169 -0.24627741981080164546 0.0123296374385337415 -0.13966897570020020414 -0.50439334701285598594 0.5193555091936240542;-0.18111108712554505051 0.67744801753055117199 -0.35973521263672242343 -0.2725148491407993756 -0.6006650283357464204 -0.053933129516773647971 0.76859320403471054206 0.23612729915257499314 0.61769674332059409938 -0.42920530984783505923 -0.14774031568094453393 -0.010588662622641437094 0.75969949812716219828 0.036785413278639898793 0.37622268698520960895;0.42456896523865922388 -0.62205293848590492711 0.34423036072155299703 0.637449063070130717 0.57469174338016648651 -0.11543011763140875736 0.12384916826930131295 0.26118668788919446877 -0.69395378322574308161 -0.62258681426246809121 -0.23130334590338283429 -0.31257590137371360495 -0.70775002085113825068 0.3600299167250554655 0.16963176905715168785;-0.087875406204489900364 0.56712659864668779619 -0.090543034012136300315 0.52949906505453103733 -0.12889422643890191544 -0.70627806273785687097 0.88219964330614220049 0.23267933445765529021 0.17461293791218868154 -0.065969264935177879261 -0.67640971949739248092 -0.60212271913843418147 -0.04166334173473641711 0.31219571707845056308 0.41523599707608460641;-0.070427505619771846312 0.064759996556490437292 0.36351943079747223164 1.4404698884329050212 -0.73191652470096502103 0.72837905695792015681 0.23430034102156119258 -0.23015000948457547958 -0.14824732940188414809 -0.091349429684624575132 -0.53447076999326625923 -0.10427557738165794954 0.48820532520581011449 0.29390393770246792116 0.13928980939379292936;0.5636716618458377237 -0.46335234837987376855 -0.30133187218271434427 0.21919372669276643295 1.3296912786503061188 -0.33286824281456617314 0.14217329945077528119 0.18436842586865256899 -0.90203364511795558478 0.092074212722878884252 -0.66211640171611962913 -0.41848935743132981147 -0.56424625463452693364 0.48936869597576776458 0.16859708250131519303;-0.30921317844166112954 -0.51796844474476400055 -0.73020697275265566972 0.02089489013174984644 0.82433134961725984535 -0.49761495216093026839 -0.30415039814623545666 -0.062674712679557903483 0.09582443081992461642 -0.75268690969859985973 -0.24137489807465978275 -0.83028521873526983654 -0.33710514744777869689 0.13231548380780358554 -1.0507592111181487393;0.010533538723922670349 0.37841032840030514039 0.0028989524401937041831 0.44003676749290465686 0.090808427617097633999 -0.14841029049537846074 -0.23124985732963426743 -0.52679024763939297227 -0.88953120493783632838 0.062054166180412220766 -0.29039479396035522418 0.7025396939075682079 -0.38256841534401714311 -0.53084656316839406998 -0.48774458337984083478;1.1169516267687598088 0.90448894705704685482 0.035079924806487597366 0.85022497295840104847 -0.32471692298846382974 0.032839792621575283893 -0.24843239596418997817 0.46979926424027079745 0.33213495782755048102 -0.04219614455645646911 -0.070245105730125392829 -0.37405842009087342248 -0.064777937597397555747 0.33251222448547962385 0.84171031226596315644;-0.80584832722865806787 0.0049903181638232679829 0.48467710911980910193 0.27439275043674743459 0.34799933195749843673 0.084406900564914899565 -0.76872144830865984932 0.29048741054299342945 0.25454040386154985764 -0.47208009622172497632 -0.15735480558183881361 0.85289106572003536844 -0.16779362070277498153 -0.31010521142612207379 -0.390114829675726138;0.6595507704120980863 0.29236771944290790293 0.39399592563650071009 -0.40111305504231636876 0.35809681686801397849 0.04609993507417194103 0.64041159653735568735 -0.10550674359933812085 -0.68657768850133249483 0.60904306825321841146 -0.6004326944429926316 0.40134196958560364177 0.026813882461997944062 -0.61893037162658759431 0.1094777493995251344;-0.29494387342282246678 0.58879737517993424589 0.33408393574534123172 0.057537986248703446024 -0.39136810327327453685 -0.019798026395612539075 -0.70147484226402956331 0.54755497278838116681 -0.46147220673830013915 0.18384714856950465367 0.10130081580017669118 -0.81284900120028502624 -0.48116005064849670658 -0.36882793944168251743 0.52518298380928474245;0.28079724574768355483 -0.78282078670017329891 -0.64958385915798766419 -0.74589171133851206452 -0.16537976875526974596 -0.1889010641922459488 -0.099380867955632223865 0.39574604600077639693 -0.60971668048366334247 -0.10534679049488898661 0.3504742842440782824 0.32346133615487920876 0.081047947564223829509 -0.53591035722667790253 -0.54049351906392428813;0.13988813507626324251 -0.319839368096370813 -0.77769792008105886882 -0.15195180157767596008 -0.36506852057526689714 0.024468147693114075669 0.53091887528357717407 -0.22815505125686830201 -0.77922677986158606078 0.71860566719471730135 -0.41704185713622332621 0.33369236416603109685 -0.36621662053638459611 0.27904002974506114665 -0.49680333711866953017];

% Layer 2
b2 = [1.2825056884421204284;0.08361383606921252154];
LW2_1 = [0.016391972835415304088 -0.43040457416242422495 -0.97584584474398772258 -0.57393131295957333649 -0.14175270998105821141 0.48321620155790656614 0.73428683910475456287 -0.66027040278441750942 0.84771017294981010348 0.67184709750474902457 -1.4598678928381514375 1.862080410033595923 -0.12748514471156940919 0.45225764240859728238 1.0662028307530151405 0.42844097205151765451 -1.2020473835526495066 0.97630226374821305058 0.41015092376619316505 -0.10792996892826334232 0.84986016942696163134 1.3475387975157846476 -1.0595931411703858327 -0.64728681871714610629 0.88227560311775876656 0.49105226823036857153 0.87902860256087533841 -0.33496849767445668888 -0.48432439167434465643 -0.12787798604559785787;0.53269202809102944585 -0.24182693660245646594 0.073957689924579933516 -0.41439433905193112651 -0.80513951980246689644 -1.2320041009503912566 -0.0083063565264865774074 0.027043376014257856227 -1.5861909217982514964 -0.3946388570543822305 1.5765122441561216782 -0.22718417176222235887 -0.30276472121687242334 -0.4851624305264535808 0.089007804640772347771 -0.88270767774092528946 -0.10673473487372311941 0.56297290556579504539 0.43948132073210671722 -0.28019096071403482018 -0.42091722264295250433 -1.1906626331425176346 0.72429308410426473941 0.21987539894531815676 -0.71044430103126177123 0.88643066397963010683 -0.66530464848051973359 0.74383934530030515475 -1.0764674596364769421 -0.28307999575297915218];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numer = exp(n);
denom = sum(numer,1);
denom(denom == 0) = 1;
a = bsxfun(@rdivide,numer,denom);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
